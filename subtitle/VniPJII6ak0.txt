大家好，这里是最佳拍档，我是大飞
之前马斯克说过
人类生活在真实世界的概率
可能只有几十亿分之一
不知道大家有没有想过
如此庞大的虚幻世界
需要使用什么的工具来构建的呢？
Google最新的研究成果给了我们一个可能的答案
那就是AI
八月二十九号
谷歌DeepMind发布了一篇名为《扩散模型是实时游戏引擎（Diffusion Models Are Real-Time Game Engines）》的论文
向我们展示了世界上第一个完全由神经模型驱动的游戏引擎
GameNGen
这也是历史上首次
AI能在没有游戏引擎的情况下
为玩家生成实时游戏了
并且在单个TPU上速度可以达到每秒20帧
论文作者兴奋地表示
只要继续深挖GameNGen
未来的游戏开发者都不需要再手动编写游戏逻辑
开发时间和成本都会显著降低
今天，大飞就来带大家了解一下
这个有可能彻底掀翻全球游戏产业的AIGC产品
在正式开始介绍GameNGen之前
我们先来搞清楚
为什么说AI做电子游戏
对于游戏行业有着颠覆性的意义呢？
这是因为制作游戏
本质上是在制作一个预先设定好的流程
无论是什么样的游戏
只要它想在电脑上运行起来
就一定要跑通以下这个循环
第一步，收集用户的输入，第二步
更新游戏的内部状态
第三步
将更新后的状态渲染为屏幕像素
无论是最简单的贪吃蛇
还是最近火热的黑神话悟空
都遵循这个最底层的逻辑
而在这个逻辑的基础上
各种性能强大的主机不断地提高游戏循环中的帧率和像素
最终为玩家创造了一种交互式虚拟世界的奇妙体验
虽然游戏行业内的企业
各自采用着不同的引擎来制作游戏
但是这些引擎在工作的时候
比如刷新游戏里 NPC 的位置
都是在按照开发者预设的代码或配置来进行的
然而，AI却为我们提供另外一种可能
借助AI
我们能不能抛开所有预设的流程
只给出一组提示词
就让 AI 引擎来实时渲染和生成所有的游戏内容呢？
最近几年来
生成模型在图像和视频方面已经取得了重大进展
比如 Stable Diffusion、Dall-E 等等
人们自然而然地想到
模拟电子游戏的交互世界
似乎与图像和视频生成
有着异曲同工之妙
然而
交互世界模拟不仅仅是非常快速的视频生成
还要求在整个生成过程中
以可用的输入动作流为条件
这就打破了现有扩散模型架构的一些假设
所以
神经网络模型到底能不能高质量地实时模拟出复杂的游戏呢？
GameNGen的回答是，能
而且能得不得了
Deep Mind的研究团队利用GameNGen运行了一款20世纪的经典游戏《DOOM》（毁灭战士）
既没有为游戏编程
也没有用上渲染引擎
然而
GemNGen 不仅做到了实时生成游戏的画面
并且可以精准地执行各种复杂的游戏状态更新
比方说计算弹药、攻击敌人、破坏物体、打开大门等等
AI 直接跳过了游戏开发的三大步骤
给出了结果
这就好像你不切菜，不倒油
把食材往锅里一倒
它就自己变成一道菜了
这对于传统的游戏研发行业而言
绝对称上是匪夷所思
那如此具有颠覆性的AIGC工具
到底是怎么被开发出来的呢？
论文的核心作者
项目负责人施洛米·弗鲁赫特Shlomi Fruchter
在社交媒体上介绍了自己开发GameNGen的过程
构建AIGC的第一步，永远是数据
想要教会一个agent玩游戏
在那么在各种场景中生成类似于人类而且足够多样化的训练数据
自然是必不可少的
这次
研究人员使用深度强化学习方法
对agent模型进行了 PPO训练
然后，以简单的CNN作为特征网络
给agent生成了一共900M的数据集
其中每一个画面都是一帧
包括了游戏角色可以执行的动作
以及玩家的操作视角
有了这个数据集
研究人员就可以对agent进行训练 、推理和微调
不过，光有数据集还不够
团队还得找个足够靠谱的模型
GameNGen 选择使用的是 Stable Diffusion 1.4
这原本是一款专注于文生图的扩散模型
但是团队对这个模型进行了一些修改
其中架构方面最重要的修改就是
让以文本为条件的模型
可以适应数据集中的动作数据和对先前帧的观察结果
这是什么意思呢？
简单地说就是帮模型做个翻译
让它可以以文本的形式
理解游戏中的动作数据
具体分三步
研究人员首先需要训练一个agent作为嵌入模块
再将agent在游戏中的每个动作
转换为单个token
这样
Stable Diffusion就能通过token读懂这些画面了
在这个基础上
研究人员再将交叉注意力中的文本
替换为编码后的动作序列
把文本又翻译回了动作
经过研究团队的这一手偷梁换柱
成功让Stable Diffusion看懂了游戏角色的每一个行动
以及对应的按键输入
除了刚刚提到的翻译
团队还对Stable Diffusion的优化方法也做了改进
他们使用一种被称为速度参数化 velocity parameterization的新方法
来最小化模型的扩散损失
与此同时
从原来的 Stable Diffusion转换为游戏引擎中的自回归采样
会不可避免地导致错误累积和样本质量的快速下降
为了避免这个问题
团队在训练生成模型的时候
会在编码过的上下文帧中
添加不同数量的高斯噪声
同时将噪声水平作为模型的输入
从而让降噪网络可以纠正先前帧中采样的信息
这些操作对于随着时间推移保证帧质量
至关重要
论文还提到，在推理过程中
也可以控制添加的噪声水平
最大限度地提高模型的生成质量
帧率也是团队需要攻克的难关之一
毕竟模型要输出的可不是一张两张图
而是20帧起步的游戏画面
帧数太低，玩家肯定是不会买账的
而谷歌的团队这次居然靠着模型的涌现
搞定了这个问题
通常
像Stable Diffusion这样的生成式扩散模型
是无法只用单个去噪步骤产生高质量结果的
而是需要数十个采样步骤
但是，令人惊讶的是
GameNGen只需要 4个去噪扩散隐式模型
简称 DDIM采样步骤
就能够稳健地模拟 DOOM
而且相比使用20个甚至更多采样步骤的时候
质量并没有明显下降
为什么会出现这样的结果
就连弗鲁赫特自己也说不清楚
他在论文中推测
这可能源于多个因素的共同作用
包括可采样的图像空间受限
以及通过先前的帧信息
施加了较强的条件限制等等
总的来说，就图像质量而言
GameNGen在长时间轨迹上的生成画面
可以达到与原始游戏相当的模拟质量
这么说可能大家不好理解，直接点说
就是大部分人根本看不出来AI做出的Doom
在画面上和原版游戏之间有什么区别
为了得到更真实的评估
研究者向10名人类评分者
分别提供了130个随机短片段
长度分别 1.6秒和3.2秒
并且还将GameNGen模拟的游戏和真实游戏并排对比
评估者们的任务
就是识别其中哪一个是真实的游戏
结果发现，针对1.6秒的游戏片段
在58%情况下
他们认为GameNGen生成游戏是真实的
而对于3.2秒的游戏片段
这个比率更高
达到了60%。
要知道
「DOOM」这款游戏一直是以复杂的3D环境和快节奏的动作闻名于世
而GameNGen的实时渲染能够完全跟上游戏的画面
让六成的人都分不出真假
已经是非常好的成绩了
AI初创公司HyperWrite的CEO 马特·舒默Matt Schumer更是直呼疯狂
他在推特上表示
如果将大多数AI模型的进展都应用到GameNGen上面
那么在几年内，我们应该就有机会
用AI来开发3A级别的游戏大作
英伟达高级科学家吉姆·范Jim Fan也感慨道
被极客们在各种洗衣机、计算器、电子秤甚至密码锁上到处移植的DOOM
竟然在纯粹的扩散模型中实现了
而且每个像素都是生成的
这太不可思议了
就连Sora跟它比起来，都黯然失色
因为Sora无法进行交互
所以还不能算是一个「数据驱动的物理引擎」。
而GameNGen 可以说是一个真正意义上的神经世界模型
它将过去帧中的状态和用户的动作作为输入
输出下一个帧
从而模拟出了一个虚拟的世界
这个质量是他见过的最令人印象深刻的DOOM
不过，作为英伟达的科学家
深谙游戏的Jim也指出了GameNGen中存在的一些限制
比如说
GameNGen在单个游戏上拟合到了极致
反而可能会丢失模型的通用性
没法模拟其他的游戏了
总不能一款Doom玩到死吧
还有
GameNGen虽然很好地模拟了数据集中的游戏场景
但是它无法创作新的场景
也无法合成新的游戏或者交互机制
更做不到像一开始预想的那样
给模型一串提示词
它就可以直接创造出一个可玩的游戏世界
而且
现在GameNGen能够稳定生成的画面也就20FPS
而现代的电子游戏都已经达到了60帧甚至120帧
GameNGen生成一下Doom这样的老游戏还算可以
但是想要让它参与进现代游戏的开发
GameNGen的性能还远远不够
因此
尽管GameNGen确实颠覆了以往的游戏开发流程
但是以上的这些问题
都让它在实际应用中的效果大打折扣
不过
我们也不必对一个刚刚出现的技术如此苛刻
不少大佬都很看好AI生成游戏的未来
比如做游戏硬件起家的老黄就是其中的一个
在今年GTC大会的记者会上
比拉瓦尔·西杜Bilawal Sidhu问了老黄一个问题
我们距离每个像素都以实时帧速率生成的世界
还有多远？
老黄的回答特别乐观，他说
我们只需要再等 5 到 8年的时间
并且他现在已看到了跨越创新S曲线的迹象
GameNGen的出现
可以说又一次印证了老黄的预言
它表明
当前确实存在一种架构和模型权重
可以让神经网络能够在现有的 GPU上
有效地交互和运行复杂的虚拟环境
在这种架构下
我们只要提供足够多的数据
就可以将一组帧
转化为一个全新可玩的关卡
或者通过一张示例图像
来创建一个新的角色
这意味着，我们在未来将有机会
彻底告别靠写代码来做游戏的时代
人人都可以靠AI 来做自己喜欢的游戏
正如论文作者所说
他们希望这小小一步的尝试
能够让人们对游戏的体验
甚至对日常软件系统的交互
带来极大的改善
好了
以上就是对GameNGen的简单介绍了
就在GameNGen发布的前一天
国内知名游戏公司米哈游的前董事长蔡浩宇
就在领英上发布帖子，他表示
AIGC 已经彻底改变了游戏行业
大规模应用只是时间问题
未来
只有两种类型的游戏开发者才是有意义的
一是前 0.0001%的天才
他们负责创造前所未有的游戏；
剩下的99.9999% 则是纯粹的游戏爱好者
他们创作游戏纯粹是为了满足自己
至于其他普通或者专业的游戏开发者
还是尽早转行吧
现在看来
蔡浩宇可能是提前得到了某些关于GameNGen的风声
又或者看到了什么更先进的模型
才会发出如此的感慨吧
那么大家是如何看待GameNGen 对传统游戏开发行业的影响呢？
欢迎在评论区留言，感谢大家的观看
我们下期再见
