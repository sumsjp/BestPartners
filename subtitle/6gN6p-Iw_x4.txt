大家好，这里是最佳拍档，我是大飞
很早就有观众让我讲一下FSD
最近终于抽出了点时间来梳理一下
FSD全称是Full-Self Driving
翻译过来就是完全自动驾驶
是特斯拉为其电动车研发的自动驾驶系统
FSD在V12版本由于采用了端到端技术
几个月的时间就超过了几年积累的V11
可以说是一个划时代的版本
所以我们今天就主要以V12为分界线
聊聊它的前世今生
以及自动驾驶的相关概念
作为一个普及性的视频
我们这期并不会介绍太深的技术细节
而是想让大家对FSDV12有个大概的了解
后续我们会再一步一步的详细介绍
那在介绍FSD之前
我们先得来介绍一下自动驾驶的整体框架
目前被国内外广为接受的
是国际汽车工程学会
简称SAE制定的自动驾驶分级标准
从L0-L5共6个级别，从小到大
车辆的自动驾驶程度也越来越高
L0，无自动化
没有任何高级辅助驾驶ADAS功能
司机完全自己控制
也就是我们通俗理解上的自己开车
L1，提供有限的辅助驾驶功能
能够控制车辆的制动或者转向
在一定程度上完成车道偏离修正或者自动巡航
帮助司机控制方向盘或者油门刹车
L2
辅助驾驶系统能够同时完成制动、转向、车道偏离修正、自动巡航
在紧急情况下可以通过传感器进行紧急制动
L0、L1、L2这三个级别还属于辅助驾驶
就是司机自己必须处于驾驶状态
负责车辆的行驶安全
而到了L3这个级别
就进入了有条件的自动驾驶
可以应对拥堵路况行驶
你坐在驾驶员座位上就行
但是紧急情况下你还需要接管车辆
而到了L4
可以说就进入高度自动化了
理论上不再需要方向盘和油门刹车了
大部分情况下都可以自动驾驶
而L5则称为完全自动驾驶
无论任何路况、天气
车辆都可以行驶的很好
实现真正的无人驾驶
那大概了解了自动驾驶的各个级别之后
我们来介绍一下车辆是怎么实现自动驾驶的
目前
自动驾驶的设计理念可以分为两类
分别是传统的模块化设计和最新的端到端设计
我们分别来说明一下
所谓模块化设计
就是把自动驾驶的过程
分成了感知、决策规划、执行控制三大模块
研究人员通过调试每个模块的参数
来让车辆适应各种不同的场景
其中
感知模块负责收集和解释车辆周围环境的信息
再通过各种传感器
比如摄像头、激光雷达、雷达、毫米波等等
来检测和识别周围物体
在端到端技术出现之前
感知模块是自动驾驶的核心
目的就是让汽车的感知水平可以达到人类的水平
就像人类在开车的时候一样
注意到红灯、车辆加塞
或者是马路上突然横穿了一个动物
而决策规划模块
则是基于感知模块输出的结果
预测其他交通参与者的行为和意图
并且制定车辆的行驶策略
确保车辆安全、高效、舒适地到达目的地
这个模块就像是车辆的大脑
可以随时根据预设的代码规则
思考应该采取的行为
比如什么时候要变道超车、让不让车、行驶路线如何选择等等
要注意的是
这个模块传统上的实现方式是基于代码规则
也就是通过代码形式提前写好的规则
来进行决策规划
显然
缺点就是如果出现没有对应规则的情况
车辆就不知道该如何应对了
而第三部分控制模块
则负责执行决策模块输出的行驶策略
比如控制油门、刹车和转向
模块化设计的好处在于可解释、可验证、模块参数方便调试
但是缺点也非常明显
首先是信息在传递过程中容易出现损耗
就跟玩传话游戏一样容易失真
其次是实际要面对的任务很复杂
导致规则执行的效率较低并且存在误差
更关键的是
基于规则的逻辑难以穷尽
实际构建和维护的成本太高
比如车辆行驶前面突然出现一头大象
或者跑过一只老鼠
这种小概率事件无法用规则一一覆盖
讲完了模块化，我们接下来看看
目前行业最认可的端到端究竟是什么
所谓端到端，End-to-End
其实就是信息从一头进入
从一头输出
中间没有各个模块传输来传输去
一站式的服务
整个过程基于统一的神经网络
从原始传感器数据输入
直接到控制指令输出
可以进行连续的学习与决策
过程中不涉及任何显式的中间表示
或者人为设计的模块
也不再需要工程师去写无穷无尽的代码了
所以信息也可以做到无损的传递
打个比方
以前就像是很多人在玩传话游戏
而端到端则直接变成了你说我听
虽然端到端的学习一开始可能像是个菜鸟新手
但是随着学习和数据积累
逐渐就会变成一个真正的老司机
不过
目前端到端的实现也有大致三种分类
分别是显式端到端、隐式端到端
以及基于大语言模型的端到端
显式端到端自动驾驶
是将原有的算法模块替代为神经网络
并且相互连接，形成端到端的算法
从而实现从手写规则向基于深度学习的模式进行转变
不过
这种端到端还不能算完全的端到端
中间模块的划分还是比较明显
而隐式的端到端
则利用海量传感器接收到的外部环境数据
忽略中间的过程
直接监督最终的控制信号进行训练
中间没有任何额外的模块
从而构建出一个整体化的基础模型
而基于大语言模型的端到端
则主要效仿大语言模型人机互动的模式
输入与环境有关的问题
让它直接输出驾驶决策
这其中，大模型的作用主要有两点
一是低成本生成海量的、接近真实的多样化训练视频数据
自动驾驶采用的训练数据通常有两类
一种是正常行驶记录的数据
这种数据价值较低
却占了公开数据的90%左右
另一种就是事故数据
也就是错误示范
但是这些数据采集的成本高、效率低
缺乏多样性和交互性
所以生成式AI大模型
能够帮助生成海量的多样化数据
减少人工标注，降低成本
二是大模型可以通过自然数据
自己推理学习因果
无需标注，即可以自回归的方式
从上一个场景预测下一个场景
目前根据特斯拉自动驾驶负责人阿肖克·艾鲁斯瓦米Ashok Elluswamy透露的信息
特斯拉的端到端实现
很有可能就是基于大语言模型的端到端
端到端架构的优点包括
无损的信息传递、完全由数据驱动、具备学习能力
以及更加具备泛化性
但是它也同样带有大模型的各种缺点
比如不可解释、参数过大、算力不足和幻觉等等问题
好了
以上就是自动驾驶的一些基本概念了
不过也只是粗略介绍而已，接下来
我们重点介绍一下特斯拉FSD V12的前世今生
2014年
特斯拉发布了第一代硬件Hardware 1.0
由以色列的汽车科技公司Mobileye提供
但是由于Mobileye提供的是一个封闭的黑盒方案
特斯拉无法修改其中的算法
也不能与Mobileye共享车辆数据
所以随着2016年
特斯拉发生了全球首起自动驾驶致命事故
双方合作结束
之后特斯拉开始了自研自动驾驶之路
2017年
之前在斯坦福任教的安德烈卡帕西Andrej Karpathy加入特斯拉
研发速度开始提升
2019年，Hardware升级到了3.0版本
并且采用了第一代自主研发的FSD1.0芯片
增加了影子模式功能
帮助特斯拉收集到了大量的自动驾驶数据
为纯视觉的技术路线打下基础
同年
特斯拉的算法架构开始转向神经网络
提出了HydraNet九头蛇算法
这是一种复杂的神经网络
用来帮助汽车“看见”和“理解”周围的环境
它有三大优点
分别是特征共享、任务解耦
以及能够缓存特征
2020年
特斯拉开始聚焦纯视觉的自动驾驶方向
并且在2021和2022的AI Day上
接连公布了BEV加Occupancy的网络架构
其中BEV的全称是Birds’Eye View
也就是鸟瞰视角
也就是从上往下看的俯视视角
通过这种视角
可以将特斯拉八个摄像头拍摄到的图像拼接在一起
生成一个完整的道路和周围环境的平面2D图
再结合Transformer
将平面2D图融合成一个3D视角的鸟瞰图
而Occupancy占用网络的加入
让BEV从2D变成了真正意义上的3D
并且在加入基于光流法的时间流信息之后
完成了由3D向4D的过度
同时
BEV+Transformer解决了自动驾驶车辆对高精地图依赖的问题
而Occupancy占用网络则解决了障碍物识别率低的问题
在这个阶段
FSD仍然属于模块化的设计
主要在优化感知模块
也就是如何让车辆
各种传感器输入的信息
而决策规划模块则依然较为传统
采用类似谷歌AlphaGo的蒙特卡洛树搜索+神经网络的方案
快速遍历所有可能性
找出胜率最高的路径
其中包含了大量人为输入的代码规则
而控制模块则更多是如何控制油门刹车方向盘等硬件层面的事情
2023年
特斯拉宣布FSD V12采用端到端技术
迭代速度大幅加快
原来30多万行的C++代码被缩减到几千行
但是无论是消费者还是从业者
都纷纷表示特斯拉FSD V12的表现更像人类了
影响端到端的因素主要有三点
分别是端到端的模型本身、海量的高质量行车数据
以及大规模的算力储备
从阿肖克在2023 CVPR的演讲上
我们大概可以推断FSD V12的端到端模型
可能是基于原有的Occupancy构建
而数据方面
马斯克曾经在财报会议中提到
用100万个视频Case训练，勉强够用；
200万个，稍微好一些；
300万个，就会感觉到Wow；
到了1000万个，就变得难以置信了
得益于特斯拉自身的影子模式
数百万辆已经销售出去的特斯拉汽车
正在帮助FSD收集行驶数据
截至2024年4月6日
FSD用户的累计行驶里程已经超过10亿英里
当然，数据质量也很重要
Andrej Karpathy曾经表示过
特斯拉自动驾驶部门其实将四分之三的精力
用在采集、清洗、分类、标注高质量数据上
只有四分之一的精力
用来探索算法和创建模型
由此可见数据的重要性
而在算力方面，2024年初
马斯克曾经表示算力制约了FSD功能的迭代
但是从3月份开始
马斯克就表示算力不再是问题了
在Dojo芯片投入量产之后
特斯拉的AI集群
由原先不到5EFLOPS的算力规模
迅速提升到了全球前5的水平
并且有望在今年10月
达到100EFLOPS的算力规模
这大概相当于30万张A100的水平
算力背后也意味着巨大的资金投入
马斯克表示今年将在自动驾驶领域
投资超过100亿美元，在未来
一年10亿美元也许只能作为这个行业的入场券了
今年7月23日
FSD V12发布了12.5版本
参数比12.4版本提高了5倍之多
同时整合了城市和高速公路的自动驾驶软件堆栈
可以适应更广泛的路况
目前FSD的最新版本为12.5.1.3
自从特斯拉全面转向端到端技术以来
国内的自动驾驶厂商也纷纷开始跟随
但是无论是高质量的数据
还是大规模算力方面
都还相差非常多
基本上比FSD要落后一到两年的时间
虽然目前特斯拉FSD V12的运行区域还主要是在美国
但是基于端到端强大的学习能力与迭代速度
相信也能很快适应中国的各种道路情况
而且特斯拉已经在北京和上海开始了基于FSD的道路测试
同时也在向工信部申请备案
有希望在年底向特斯拉用户推送FSD
据说每个月的订阅费用为710元人民币
好了，以上就是对特斯拉FSD的介绍了
从V12开始
可以说是FSD的一个分水岭
在这波AI浪潮的推动下
端到端的设计也迅速被行业所接受
大飞我也很期待早日看到自动驾驶技术的突破
真正实现向L5的迈进
本期视频只能算是一个概览
等今年AI Day召开后
再跟大家分享更多有关FSD的最新进展和细节
感谢大家的观看，我们下期再见
