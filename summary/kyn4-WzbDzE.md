好的，我來幫你整理這份文稿，讓它更清晰、更結構化：

**標題：閏年Bug再襲！從激光雷達到ChatGPT，科技巨頭紛紛中招**

**開場：**

*   大家好，這裡是最佳拍檔，我是大飛。
*   2月29日，禾賽科技激光雷達傳出固件Bug，引發自動駕駛功能癱瘓。

**禾賽科技事件：**

*   禾賽科技是國內領先的激光雷達企業，全球首家單月交付量突破5萬的公司。
*   問題：老款L4機械式激光雷達出現軟體Bug，閏年導致。
*   解決方案：禾賽科技表示已找到原因，預計24小時內解決。

**閏年Bug普遍性：**

*   閏年（366天）是為了彌補曆法與實際地球公轉週期差距而設。
*   閏年問題並非禾賽科技獨有，許多公司都未做好準備。

**其他受影響案例：**

*   **OpenAI：** ChatGPT 3.5 認為 “2024-02-29” 不是有效日期，導致API使用錯誤。
*   **新西蘭加油站：** 全國無人值守加油站因技術供應商Invenco的系統無法處理2月29日而停機。
*   **哥倫比亞航空 (Avianca)：** 列印出錯誤的機票日期（3/1而非2/29），需要重新下載登機牌。
*   **印度智能手錶 Fastrack FS1：** 2月28日晚11:59後停止運作，官方已承認故障並努力修復。
*   **YouTube：** 用戶無法購買YouTube Premium訂閱，因年齡驗證邏輯錯誤（閏日出生者被認為未滿18歲）。
*   **EA Sports賽車遊戲 (EA SPORTS WRC)：** 遊戲崩潰，官方建議將系統日期設為3月1日或休息。

**歷史閏年Bug：**

*   **2012年：** 微软Azure雲服務因證書到期日期的計算錯誤而中断12小時。
*   **2010年：** 索尼PlayStation網路中断，原因為系統錯誤地將2010年識別為閏年。
*   **2008年：** 微软Zune设备集體變成板磚，因12月31日邏輯錯誤。
*   **2008年：** 微软Exchange管理bug，導致管理員在2月29日無法執行大部分操作。
*   **Lotus 1-2-3：** 對1900年的計算錯誤，至今仍影響微软Excel。

**閏年Bug的技術根源（C/C++）：**

*   Win32 API 的 SYSTEMTIME 結構可能在非閏年產生 2月29日的錯誤日期。
*   為一年中每一天的值宣告陣列時，閏年可能導致陣列超出界限（Buffer溢出）。
*   資料過濾：範圍查詢未考慮額外的閏日，導致查詢結果不正確。

**解決方案：**

*   **.NET:** 使用 `AddYear(-1)` 方法。
*   **JavaScript:** 使用 `moment.js` 或自定義函數，避免直接計算天數。
*   儘量不要具体计算需要添加的天数来解决问题，那样更容易出错

**開發者常犯的閏年錯誤：**

*   弄錯閏年算法（并非每四年一次，考慮能被100和400整除的年份）。
*   為每個月份使用天數的陣列，未考慮2月29日。
*   考慮到閏年，但未測試所有代碼路徑。
*   使用單獨的年、月和日，但未進行驗證。

**開發者如何避免閏年Bug：**

*   認真檢查與時間相關的代碼。
*   進行充分的單元測試，了解如何正確模擬時鐘。
*   對系統進行全年測試，而不僅僅在閏年之前測試。
*   對所有輸入進行驗證，包括配置部分。
*   使用靜態代碼分析工具。
*   直接快進到下一個閏日，看看會發生什麼。

**結論：**

*   閏年Bug雖然不像千年蟲那樣轟動，但仍是一個持續存在的挑戰。
*   建議開發者花時間掃描和測試代碼，防患於未然。

**結尾：**

*   感謝大家的觀看，我們下期再見。

**整理說明：**

*   **結構化：** 將文稿分成幾個主要部分，每個部分都有明確的標題，使文章更有層次感。
*   **簡潔化：** 刪除一些口語化的表達，使文章更專業。
*   **突出重點：** 強調閏年Bug的普遍性以及各種案例，讓讀者更容易理解問題。
*   **提供解決方案：** 提供了一些程式碼範例和開發者應對閏年Bug的建議。

希望這樣的整理對您有幫助！如果需要進一步修改或調整，請隨時告訴我。

[model=gemini-2.0-flash,0]
